import pandas as pd
import numpy as np
import requests
import xml.etree.ElementTree as ET

'''
preciso da lista de clientes
e das regras de recomendações
'''

# request para acessar lista de produtos da bol
url_xml = "https://www.bemol.com.br/feeds/google-merchant"
header = { "Accept": "application/xml" }
r = requests.get(url_xml, headers=header)

tree =  ET.ElementTree(ET.fromstring(r.content))
root = tree.getroot()

# Gera um DataFrame com os produtos da BOL
codigos, produtos, images, links, precos = ([] for i in range(5))
for channel in root.findall("channel"):
    for item in channel.findall("item"):
        for sem_imagem in item.findall("{http://base.google.com/ns/1.0}image_link"):
            sem_imagem.tag = "{http://base.google.com/ns/1.0}additional_image_link"
        for title in item.findall("title"):
            produtos.append(title.text)
        for image in item.findall("{http://base.google.com/ns/1.0}additional_image_link"):
            images.append(image.text)
        for link in item.findall("link"):
            links.append(link.text)
        for preco in item.findall("{http://base.google.com/ns/1.0}price"):
            precos.append(float(preco.text.replace(" BRL", "")))
        for codigo in item.findall("{http://base.google.com/ns/1.0}mpn"):
            codigos.append(int(codigo.text))

df_produtos = pd.DataFrame({ 'Nome': produtos, 'Imagem': images, 'Link': links, 'Preco': precos}, index=codigos)

url = "http://transacional-apiv2.allin.com.br/api/email/bulk"

emails_teste = ['matheusamorim@bemol.com.br', 'matheushenrique.py@gmail.com', 'matheus.amorim@outlook.pt']

headers = {
  "Accept": "application/json",
  "Content-Type": "application/json",
  "Authorization": "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjRhMjNkYTg5ZmIxODI2NmE3NzYxZjY4ZmVhNDg0OTFiNzA5MWI5N2Q2N2EwMGY1YjU0N2E3M2FlYmE0MGY1ZWVhZTc0MGJkNjhkYzg4ZjM0In0.eyJhdWQiOiIyODYiLCJqdGkiOiI0YTIzZGE4OWZiMTgyNjZhNzc2MWY2OGZlYTQ4NDkxYjcwOTFiOTdkNjdhMDBmNWI1NDdhNzNhZWJhNDBmNWVlYWU3NDBiZDY4ZGM4OGYzNCIsImlhdCI6MTU4NTE0MzcwNywibmJmIjoxNTg1MTQzNzA3LCJleHAiOjE1ODY0Mzk3MDcsInN1YiI6IjU5NDYiLCJzY29wZXMiOltdfQ.jSexy_3znOcLWcsckW24YzCZzgorbmBV0T2cDW8jvDgOV6jJ7xtgNsqPDzKIZ9TFdhcBzkmEHaK5lyhWokfgaNXnO9WWIkdz2dIzbTs52jfhoM2UKuZPUfO6nkHBbq8SiFwYJFyuwnH-eY8DbBYBuFeSdZK0n9fRelJqtkBnVYNtm_88TnpoeJiFsZwtyb1R7eDsQ-HyuuIWda6kNVsikEs94_U36rqxkvyqbUPqO_DwMZRLcfvaQ7aqLYSgicMTnv6B_-v46kKCkdFCQ3EfvnPPCTsBh05_S0y8ImRvW7L0frhLGXMn_83ZPAAOlK5e8lDM8egcwgGpqHbu3lWDiJjZBwDe9LsGyWXjS4fhgYWSc49sSQvP0QoNNoUmaVl5a3YYT_UuDsBWNkpL1tX4egmGaQIgxtlE2cBhpA5vnr03yeYDwZkbcepDVh--J-GsOLY5gAgXvRydjp4YfBnjXffeVfiTDQNSFFs8mxAnX0Iq9CMcjzDxv58J64gQ9Ara6N9EDUfdh4cvQrrOwMRwwsKH_hrZcPGIBdm4LqIXMQxwYsSzQ95BgWPspl2ad9aFFC-pGaTDcIB-sWMN6BuzWErsNSrhLYl_TLUl7cMO7mBq7Jt-qZssMHoQxWxqKYBqsCzR_fuQRye6ZD4K6i8m2VS1zZLdAk4yryC8yhbJuOQ"
}
template = "PGh0bWw+CjwhLS0gSFRNTCA0IC0tPgo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCI+CjwhLS0gSFRNTDUgLS0+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KPGhlYWQ+CjwvaGVhZD4KPGJvZHkgc3R5bGU9ImZvbnQtZmFtaWx5OiAnTHVjaWRhIFNhbnMnLCAnTHVjaWRhIFNhbnMgUmVndWxhcicsICdMdWNpZGEgU2FucyBVbmljb2RlJywgJ1ZlcmRhbmEnLCBzYW5zLXNlcmlmO2JhY2tncm91bmQtY29sb3I6ICNlZWVlZWU7Ij4KICAgIDxkaXYgY2xhc3M9ImNvcnBvIiBzdHlsZT0ibWF4LXdpZHRoOiA3MDBweDttYXJnaW46IGF1dG87ZGlzcGxheTogYmxvY2s7b3ZlcmZsb3c6IGF1dG87YmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsiPgogICAgICAgIDxoZWFkZXI+CiAgICAgICAgICAgIDxpbWcgc3JjPSJkYXRhL2NhYmVjYWxoby5wbmciICwgYWx0PSJsb2dvIExvamFzIEJlbW9sIiBjbGFzcz0iY2FiZWNhbGhvIiBzdHlsZT0ibWF4LXdpZHRoOiAxMDAlO2hlaWdodDogYXV0bztvYmplY3QtZml0OiBzY2FsZS1kb3duOyI+CiAgICAgICAgPC9oZWFkZXI+CgogICAgICAgIDxkaXYgY2xhc3M9InJlY29tZW5kYWNhbyIgc3R5bGU9IndpZHRoOiBjYWxjKDEwMCUgLSA0MHB4KTtoZWlnaHQ6IDIwMHB4O21hcmdpbjogMjBweDsiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJlc3F1ZXJkYSIgc3R5bGU9IndpZHRoOiA1MCU7dGV4dC1hbGlnbjogbGVmdDtmbG9hdDogbGVmdDtkaXNwbGF5OiBpbmxpbmU7Ij4KICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJ7e2ltZ19wcm9kdXRvMX19IiAsIGNsYXNzPSJpbWdfcHJvZHV0byIgYWx0PSJ7e25vbWVfcHJvZHV0bzF9fSIgc3R5bGU9ImZsb2F0OiBsZWZ0O3dpZHRoOiBhdXRvO2hlaWdodDogMjAwcHg7b2JqZWN0LWZpdDogc2NhbGUtZG93bjttYXJnaW4tYm90dG9tOiAxMHB4OyI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkaXJlaXRhIiBzdHlsZT0id2lkdGg6IDUwJTt0ZXh0LWFsaWduOiByaWdodDtmbG9hdDogcmlnaHQ7ZGlzcGxheTogaW5saW5lOyI+CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIDxlbSBzdHlsZT0iZm9udC1zdHlsZTogbm9ybWFsO2ZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTRweDt0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO2Rpc3BsYXk6IGJsb2NrOyI+e3tub21lX3Byb2R1dG8xfX08L2VtPgogICAgICAgICAgICAgICAgPHN0cm9uZyBzdHlsZT0iY29sb3I6ICNkZDM5Mzc7Zm9udC1zaXplOiAyMHB4OyI+e3twcmVjb19wcm9kdXRvMX19PC9zdHJvbmc+CiAgICAgICAgICAgICAgICA8c21hbGw+NHggZGUge3twYXJjZWxhX3Byb2R1dG8xfX0gbm8gQ2FydMOjbyBCZW1vbDwvc21hbGw+CiAgICAgICAgICAgICAgICA8YSBocmVmPSJ7e2xpbmtfcHJvZHV0bzF9fSIgLCBjbGFzcz0iYnRfY29tcHJhciIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTZweDtjb2xvcjogI2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246IG5vbmU7dGV4dC1hbGlnbjogY2VudGVyO2Rpc3BsYXk6IGlubGluZS1ibG9jazt3aWR0aDogMTUwcHg7cGFkZGluZzogMTBweCAyMHB4O21hcmdpbi10b3A6IDEwcHg7YmFja2dyb3VuZC1jb2xvcjogI2RkMzkzNztib3JkZXItcmFkaXVzOiAxMHB4OyI+Q09NUFJBUjwvYT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InJlY29tZW5kYWNhbyIgc3R5bGU9IndpZHRoOiBjYWxjKDEwMCUgLSA0MHB4KTtoZWlnaHQ6IDIwMHB4O21hcmdpbjogMjBweDsiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJlc3F1ZXJkYSIgc3R5bGU9IndpZHRoOiA1MCU7dGV4dC1hbGlnbjogbGVmdDtmbG9hdDogbGVmdDtkaXNwbGF5OiBpbmxpbmU7Ij4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGVtIHN0eWxlPSJmb250LXN0eWxlOiBub3JtYWw7Zm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxNHB4O3RleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7ZGlzcGxheTogYmxvY2s7Ij57e25vbWVfcHJvZHV0bzJ9fTwvZW0+CiAgICAgICAgICAgICAgICA8c3Ryb25nIHN0eWxlPSJjb2xvcjogI2RkMzkzNztmb250LXNpemU6IDIwcHg7Ij57e3ByZWNvX3Byb2R1dG8yfX08L3N0cm9uZz4KICAgICAgICAgICAgICAgIDxzbWFsbD40eCBkZSB7e3BhcmNlbGFfcHJvZHV0bzJ9fSBubyBDYXJ0w6NvIEJlbW9sPC9zbWFsbD4KICAgICAgICAgICAgICAgIDxhIGhyZWY9Int7bGlua19wcm9kdXRvMn19IiAsIGNsYXNzPSJidF9jb21wcmFyIiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxNnB4O2NvbG9yOiAjZmZmZmZmO3RleHQtZGVjb3JhdGlvbjogbm9uZTt0ZXh0LWFsaWduOiBjZW50ZXI7ZGlzcGxheTogaW5saW5lLWJsb2NrO3dpZHRoOiAxNTBweDtwYWRkaW5nOiAxMHB4IDIwcHg7bWFyZ2luLXRvcDogMTBweDtiYWNrZ3JvdW5kLWNvbG9yOiAjZGQzOTM3O2JvcmRlci1yYWRpdXM6IDEwcHg7Ij5DT01QUkFSPC9hPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGlyZWl0YSIgc3R5bGU9IndpZHRoOiA1MCU7dGV4dC1hbGlnbjogcmlnaHQ7ZmxvYXQ6IHJpZ2h0O2Rpc3BsYXk6IGlubGluZTsiPgogICAgICAgICAgICAgICAgPGltZyBzcmM9Int7aW1nX3Byb2R1dG8yfX0iICwgY2xhc3M9ImltZ19wcm9kdXRvIiBhbHQ9Int7bm9tZV9wcm9kdXRvMn19IiBzdHlsZT0iZmxvYXQ6IGxlZnQ7d2lkdGg6IGF1dG87aGVpZ2h0OiAyMDBweDtvYmplY3QtZml0OiBzY2FsZS1kb3duO21hcmdpbi1ib3R0b206IDEwcHg7Ij4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InJlY29tZW5kYWNhbyIgc3R5bGU9IndpZHRoOiBjYWxjKDEwMCUgLSA0MHB4KTtoZWlnaHQ6IDIwMHB4O21hcmdpbjogMjBweDsiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJlc3F1ZXJkYSIgc3R5bGU9IndpZHRoOiA1MCU7dGV4dC1hbGlnbjogbGVmdDtmbG9hdDogbGVmdDtkaXNwbGF5OiBpbmxpbmU7Ij4KICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJ7e2ltZ19wcm9kdXRvM319IiAsIGNsYXNzPSJpbWdfcHJvZHV0byIgYWx0PSJ7e25vbWVfcHJvZHV0bzN9fSIgc3R5bGU9ImZsb2F0OiBsZWZ0O3dpZHRoOiBhdXRvO2hlaWdodDogMjAwcHg7b2JqZWN0LWZpdDogc2NhbGUtZG93bjttYXJnaW4tYm90dG9tOiAxMHB4OyI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJkaXJlaXRhIiBzdHlsZT0id2lkdGg6IDUwJTt0ZXh0LWFsaWduOiByaWdodDtmbG9hdDogcmlnaHQ7ZGlzcGxheTogaW5saW5lOyI+CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIDxlbSBzdHlsZT0iZm9udC1zdHlsZTogbm9ybWFsO2ZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTRweDt0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO2Rpc3BsYXk6IGJsb2NrOyI+e3tub21lX3Byb2R1dG8zfX08L2VtPgogICAgICAgICAgICAgICAgPHN0cm9uZyBzdHlsZT0iY29sb3I6ICNkZDM5Mzc7Zm9udC1zaXplOiAyMHB4OyI+e3twcmVjb19wcm9kdXRvM319PC9zdHJvbmc+CiAgICAgICAgICAgICAgICA8c21hbGw+NHggZGUge3twYXJjZWxhX3Byb2R1dG8zfX0gbm8gQ2FydMOjbyBCZW1vbDwvc21hbGw+CiAgICAgICAgICAgICAgICA8YSBocmVmPSJ7e2xpbmtfcHJvZHV0bzN9fSIgLCBjbGFzcz0iYnRfY29tcHJhciIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTZweDtjb2xvcjogI2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246IG5vbmU7dGV4dC1hbGlnbjogY2VudGVyO2Rpc3BsYXk6IGlubGluZS1ibG9jazt3aWR0aDogMTUwcHg7cGFkZGluZzogMTBweCAyMHB4O21hcmdpbi10b3A6IDEwcHg7YmFja2dyb3VuZC1jb2xvcjogI2RkMzkzNztib3JkZXItcmFkaXVzOiAxMHB4OyI+Q09NUFJBUjwvYT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxmb290ZXI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImF2aXNvX2FiZXJ0byIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmM2MDA7cGFkZGluZzogMTBweDsiPgogICAgICAgICAgICAgICAgPGgxIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7Zm9udC1zaXplOiAyMHB4O2ZvbnQtd2VpZ2h0OiBib2xkOyI+QXMgZmFybcOhY2lhcyBlc3TDo28gYWJlcnRhcyBwYXJhIHBhZ2FtZW50b3MgZGUgcGFyY2VsYXMgZG8gY2FybsOqIEJlbW9sITwvaDE+CiAgICAgICAgICAgICAgICA8YSBocmVmPSIjIiAsIGNsYXNzPSJidF9ob3JhcmlvcyIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTZweDtjb2xvcjogI2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246IG5vbmU7dGV4dC1hbGlnbjogY2VudGVyO2Rpc3BsYXk6IGJsb2NrO3dpZHRoOiAzMDBweDtwYWRkaW5nOiAxMHB4IDIwcHg7bWFyZ2luOiBhdXRvO2JhY2tncm91bmQtY29sb3I6ICNkZDM5Mzc7Ym9yZGVyLXJhZGl1czogMTBweDtib3gtc2hhZG93OiAxcHggMXB4IDJweCAjM0Q0NTREOyI+Q09ORklSQSBPUyBIT1LDgVJJT1M8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjZW50cmFsX2F0ZW5kaW1lbnRvIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzAwOTdkODtwYWRkaW5nOiAxMHB4OyI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzb2NpYWxfY29uanVudG8iIHN0eWxlPSJkaXNwbGF5OiBmbGV4O2p1c3RpZnktY29udGVudDogY2VudGVyO21hcmdpbjogMjBweDsiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlZGVzX3NvY2lhaXMiIHN0eWxlPSJ3aWR0aDogNzVweDtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL2JlbW9sb25saW5lIiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxMHB4O2NvbG9yOiAjZmZmZmZmO3RleHQtZGVjb3JhdGlvbjogbm9uZTt0ZXh0LWFsaWduOiBjZW50ZXI7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJkYXRhL2ZhY2Vib29rLnBuZyIgLCBjbGFzcz0ibG9nb19zb2NpYWwiIHN0eWxlPSJtYXJnaW46IGF1dG87ZGlzcGxheTogYmxvY2s7d2lkdGg6IDQwcHg7aGVpZ2h0OiBhdXRvO29iamVjdC1maXQ6IHNjYWxlLWRvd247Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT48cD5mYWNlYm9vazwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVkZXNfc29jaWFpcyIgc3R5bGU9IndpZHRoOiA3NXB4O2Rpc3BsYXk6IGlubGluZS1ibG9jazsiPgogICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL0JlbW9sT25saW5lIiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxMHB4O2NvbG9yOiAjZmZmZmZmO3RleHQtZGVjb3JhdGlvbjogbm9uZTt0ZXh0LWFsaWduOiBjZW50ZXI7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJkYXRhL3R3aXR0ZXIucG5nIiAsIGNsYXNzPSJsb2dvX3NvY2lhbCIgc3R5bGU9Im1hcmdpbjogYXV0bztkaXNwbGF5OiBibG9jazt3aWR0aDogNDBweDtoZWlnaHQ6IGF1dG87b2JqZWN0LWZpdDogc2NhbGUtZG93bjsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPjxwPnR3aXR0ZXI8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlZGVzX3NvY2lhaXMiIHN0eWxlPSJ3aWR0aDogNzVweDtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9iZW1vbG9ubGluZS8iIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDEwcHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9ImRhdGEvaW5zdGFncmFtLnBuZyIgLCBjbGFzcz0ibG9nb19zb2NpYWwiIHN0eWxlPSJtYXJnaW46IGF1dG87ZGlzcGxheTogYmxvY2s7d2lkdGg6IDQwcHg7aGVpZ2h0OiBhdXRvO29iamVjdC1maXQ6IHNjYWxlLWRvd247Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT48cD5pbnN0YWdyYW08L3A+CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlZGVzX3NvY2lhaXMiIHN0eWxlPSJ3aWR0aDogNzVweDtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2NvbXBhbnkvYmVtb2wtZm9nLXMiIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDEwcHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9ImRhdGEvbGlua2VkaW4ucG5nIiAsIGNsYXNzPSJsb2dvX3NvY2lhbCIgc3R5bGU9Im1hcmdpbjogYXV0bztkaXNwbGF5OiBibG9jazt3aWR0aDogNDBweDtoZWlnaHQ6IGF1dG87b2JqZWN0LWZpdDogc2NhbGUtZG93bjsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPjxwPmxpbmtlZGluPC9wPgogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZWRlc19zb2NpYWlzIiBzdHlsZT0id2lkdGg6IDc1cHg7ZGlzcGxheTogaW5saW5lLWJsb2NrOyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3VzZXIvbG9qYXNiZW1vbCIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTBweDtjb2xvcjogI2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246IG5vbmU7dGV4dC1hbGlnbjogY2VudGVyOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iZGF0YS95b3V0dWJlLnBuZyIgLCBjbGFzcz0ibG9nb19zb2NpYWwiIHN0eWxlPSJtYXJnaW46IGF1dG87ZGlzcGxheTogYmxvY2s7d2lkdGg6IDQwcHg7aGVpZ2h0OiBhdXRvO29iamVjdC1maXQ6IHNjYWxlLWRvd247Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT48cD55b3V0dWJlPC9wPgogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGgyIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7Zm9udC1zaXplOiAyMHB4O2ZvbnQtd2VpZ2h0OiBib2xkO2NvbG9yOiAjZmZmZmZmO21hcmdpbjogMnB4OyI+Q2VudHJhbCBkZSBBdGVuZGltZW50byBCZW1vbDwvaDI+CiAgICAgICAgICAgICAgICA8aDIgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjtmb250LXNpemU6IDIwcHg7Zm9udC13ZWlnaHQ6IGJvbGQ7Y29sb3I6ICNmZmZmZmY7bWFyZ2luOiAycHg7Ij4wODAwIDcyNiA4MzAwPC9oMj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9mb290ZXI+CiAgICA8L2Rpdj4KPC9ib2R5Pgo8L2h0bWw+"

def email_campos(i):
    return {"nm_envio": "Recomendação de produtos", "nm_email": emails_teste[i], "nm_subject": "Qual o título que eu ponho?",
           "nm_remetente": "Bemol Online", "email_remetente": "no-reply@bemol.com.br", "nm_reply": "no-reply@bemol.com.br",
           "dt_envio": "2020-03-25", "hr_envio": "12:28:00",
           "campos":"nome_produto1,nome_produto2,nome_produto3,preco_produto1,preco_produto2,preco_produto3,parcela_produto1,parcela_produto2,parcela_produto3,link_produto1,link_produto2,link_produto3,img_produto1,img_produto2,img_produto3",
           "valor": df_produtos['Nome'].to_list()[i] + "," + df_produtos['Nome'].to_list()[i+1] + "," + df_produtos['Nome'].to_list()[i+2] + "," + str(df_produtos['Preco'].to_list()[i]) + "," + str(df_produtos['Preco'].to_list()[i+1]) + "," + str(df_produtos['Preco'].to_list()[i+2]) + "," + str(df_produtos['Preco'].to_list()[i]/4) + "," + str(df_produtos['Preco'].to_list()[i+1]/4) + "," + str(df_produtos['Preco'].to_list()[i+2]/4) + "," + df_produtos['Link'].to_list()[i] + "," + df_produtos['Link'].to_list()[i+1] + "," + df_produtos['Link'].to_list()[i+2] + "," + df_produtos['Imagem'].to_list()[i] + "," + df_produtos['Imagem'].to_list()[i+1] + "," + df_produtos['Imagem'].to_list()[i+2],
            "html": template}


for i in range(len(emails_teste)):
    response = requests.post("http://transacional-apiv2.allin.com.br/api/email", headers=headers, json=email_campos(i))
    print(response.json())
