import pandas as pd
from datetime import datetime, date
import requests
import xml.etree.ElementTree as ET

'''
preciso da lista de clientes
e das regras de recomendações
'''

# request para acessar lista de produtos da bol
url_xml = "https://www.bemol.com.br/feeds/google-merchant"
header = { "Accept": "application/xml" }
r = requests.get(url_xml, headers=header)

tree =  ET.ElementTree(ET.fromstring(r.content))
root = tree.getroot()

# Gera um DataFrame com os produtos da BOL
codigos, produtos, images, links, precos = ([] for i in range(5))
for channel in root.findall("channel"):
    for item in channel.findall("item"):
        for sem_imagem in item.findall("{http://base.google.com/ns/1.0}image_link"):
            sem_imagem.tag = "{http://base.google.com/ns/1.0}additional_image_link"
        for title in item.findall("title"):
            produtos.append(title.text.capitalize())
        for image in item.findall("{http://base.google.com/ns/1.0}additional_image_link"):
            images.append(image.text)
        for link in item.findall("link"):
            links.append(link.text)
        for preco in item.findall("{http://base.google.com/ns/1.0}price"):
            precos.append(float(preco.text.replace(" BRL", "")))
        for codigo in item.findall("{http://base.google.com/ns/1.0}mpn"):
            codigos.append(int(codigo.text))

df_produtos = pd.DataFrame({'Nome': produtos, 'Imagem': images, 'Link': links, 'Preco': precos}, index=codigos)

url = "http://transacional-apiv2.allin.com.br/api/email/bulk"

emails_teste = ['matheusamorim@bemol.com.br', 'matheushenrique.py@gmail.com', 'matheus.amorim@outlook.pt']

headers = {
  "Accept": "application/json",
  "Content-Type": "application/json",
  "Authorization": "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjRhMjNkYTg5ZmIxODI2NmE3NzYxZjY4ZmVhNDg0OTFiNzA5MWI5N2Q2N2EwMGY1YjU0N2E3M2FlYmE0MGY1ZWVhZTc0MGJkNjhkYzg4ZjM0In0.eyJhdWQiOiIyODYiLCJqdGkiOiI0YTIzZGE4OWZiMTgyNjZhNzc2MWY2OGZlYTQ4NDkxYjcwOTFiOTdkNjdhMDBmNWI1NDdhNzNhZWJhNDBmNWVlYWU3NDBiZDY4ZGM4OGYzNCIsImlhdCI6MTU4NTE0MzcwNywibmJmIjoxNTg1MTQzNzA3LCJleHAiOjE1ODY0Mzk3MDcsInN1YiI6IjU5NDYiLCJzY29wZXMiOltdfQ.jSexy_3znOcLWcsckW24YzCZzgorbmBV0T2cDW8jvDgOV6jJ7xtgNsqPDzKIZ9TFdhcBzkmEHaK5lyhWokfgaNXnO9WWIkdz2dIzbTs52jfhoM2UKuZPUfO6nkHBbq8SiFwYJFyuwnH-eY8DbBYBuFeSdZK0n9fRelJqtkBnVYNtm_88TnpoeJiFsZwtyb1R7eDsQ-HyuuIWda6kNVsikEs94_U36rqxkvyqbUPqO_DwMZRLcfvaQ7aqLYSgicMTnv6B_-v46kKCkdFCQ3EfvnPPCTsBh05_S0y8ImRvW7L0frhLGXMn_83ZPAAOlK5e8lDM8egcwgGpqHbu3lWDiJjZBwDe9LsGyWXjS4fhgYWSc49sSQvP0QoNNoUmaVl5a3YYT_UuDsBWNkpL1tX4egmGaQIgxtlE2cBhpA5vnr03yeYDwZkbcepDVh--J-GsOLY5gAgXvRydjp4YfBnjXffeVfiTDQNSFFs8mxAnX0Iq9CMcjzDxv58J64gQ9Ara6N9EDUfdh4cvQrrOwMRwwsKH_hrZcPGIBdm4LqIXMQxwYsSzQ95BgWPspl2ad9aFFC-pGaTDcIB-sWMN6BuzWErsNSrhLYl_TLUl7cMO7mBq7Jt-qZssMHoQxWxqKYBqsCzR_fuQRye6ZD4K6i8m2VS1zZLdAk4yryC8yhbJuOQ"
}
template = "PGh0bWw+CjwhLS0gSFRNTCA0IC0tPgo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCI+CjwhLS0gSFRNTDUgLS0+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KPGhlYWQ+PC9oZWFkPgo8Ym9keSBzdHlsZT0iZm9udC1mYW1pbHk6ICdMdWNpZGEgU2FucycsICdMdWNpZGEgU2FucyBSZWd1bGFyJywgJ0x1Y2lkYSBTYW5zIFVuaWNvZGUnLCAnVmVyZGFuYScsIHNhbnMtc2VyaWY7YmFja2dyb3VuZC1jb2xvcjogI2VlZWVlZTsiPgogICAgPGRpdiBjbGFzcz0iY29ycG8iIHN0eWxlPSJtYXgtd2lkdGg6IDcwMHB4O21hcmdpbjogYXV0bztkaXNwbGF5OiBibG9jaztvdmVyZmxvdzogYXV0bztiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyI+CiAgICAgICAgPGhlYWRlcj4KICAgICAgICAgICAgPGltZyBzcmM9Imh0dHBzOi8vZ2l0aHViLmNvbS9tYXRoZXVzaGVucmlxdWUtcHkvZW1haWxfcmVjb21lbmRhY2FvL3Jhdy9tYXN0ZXIvZGF0YS9jYWJlY2FsaG8ucG5nIiAsIGFsdD0ibG9nbyBMb2phcyBCZW1vbCIgY2xhc3M9ImNhYmVjYWxobyIgc3R5bGU9Im1heC13aWR0aDogMTAwJTtoZWlnaHQ6IGF1dG87b2JqZWN0LWZpdDogc2NhbGUtZG93bjsiPgogICAgICAgIDwvaGVhZGVyPgoKICAgICAgICA8ZGl2IGNsYXNzPSJyZWNvbWVuZGFjYW8iIHN0eWxlPSJ3aWR0aDogY2FsYygxMDAlIC0gNDBweCk7aGVpZ2h0OiAyMDBweDttYXJnaW46IDIwcHg7Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXNxdWVyZGEiIHN0eWxlPSJ3aWR0aDogNTAlO3RleHQtYWxpZ246IGxlZnQ7ZmxvYXQ6IGxlZnQ7ZGlzcGxheTogaW5saW5lOyI+CiAgICAgICAgICAgICAgICA8aW1nIHNyYz0ie3tpbWdfcHJvZHV0bzF9fSIgLCBjbGFzcz0iaW1nX3Byb2R1dG8iIGFsdD0ie3tub21lX3Byb2R1dG8xfX0iIHN0eWxlPSJ3aWR0aDogYXV0bztoZWlnaHQ6IDIwMHB4O29iamVjdC1maXQ6IHNjYWxlLWRvd247bWFyZ2luLWJvdHRvbTogMTBweDsiPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGlyZWl0YSIgc3R5bGU9IndpZHRoOiA1MCU7dGV4dC1hbGlnbjogcmlnaHQ7ZmxvYXQ6IHJpZ2h0O2Rpc3BsYXk6IGlubGluZTsiPgogICAgICAgICAgICAgICAgPGVtIHN0eWxlPSJmb250LXN0eWxlOiBub3JtYWw7Zm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxOHB4O2Rpc3BsYXk6IGJsb2NrO21hcmdpbi10b3A6IDEwcHg7Ij57e25vbWVfcHJvZHV0bzF9fTwvZW0+CiAgICAgICAgICAgICAgICA8c3Ryb25nIHN0eWxlPSJjb2xvcjogI2RkMzkzNztmb250LXNpemU6IDMwcHg7ZGlzcGxheTogYmxvY2s7dGV4dC10cmFuc2Zvcm06IGNhcGl0YWxpemU7Ij5SJCB7e3ByZWNvX3Byb2R1dG8xfX08L3N0cm9uZz4KICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT0iY29sb3I6ICM2NjY2NjY7Ij40eCBkZSBSJCB7e3BhcmNlbGFfcHJvZHV0bzF9fSBubyBDYXJ0w6NvIEJlbW9sPC9zbWFsbD4KICAgICAgICAgICAgICAgIDxhIGhyZWY9Int7bGlua19wcm9kdXRvMX19IiAsIGNsYXNzPSJidF9jb21wcmFyIiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxNnB4O2NvbG9yOiAjZmZmZmZmO3RleHQtZGVjb3JhdGlvbjogbm9uZTt0ZXh0LWFsaWduOiBjZW50ZXI7ZmxvYXQ6IGNlbnRlcjtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7d2lkdGg6IDE1MHB4O3BhZGRpbmc6IDEwcHggMjBweDttYXJnaW4tdG9wOiAxMHB4O2JhY2tncm91bmQtY29sb3I6ICNkZDM5Mzc7Ym9yZGVyLXJhZGl1czogMTBweDsiPkNPTVBSQVI8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJyZWNvbWVuZGFjYW8iIHN0eWxlPSJ3aWR0aDogY2FsYygxMDAlIC0gNDBweCk7aGVpZ2h0OiAyMDBweDttYXJnaW46IDIwcHg7Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXNxdWVyZGEiIHN0eWxlPSJ3aWR0aDogNTAlO3RleHQtYWxpZ246IGxlZnQ7ZmxvYXQ6IGxlZnQ7ZGlzcGxheTogaW5saW5lOyI+CiAgICAgICAgICAgICAgICA8ZW0gc3R5bGU9ImZvbnQtc3R5bGU6IG5vcm1hbDtmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDE4cHg7ZGlzcGxheTogYmxvY2s7bWFyZ2luLXRvcDogMTBweDsiPnt7bm9tZV9wcm9kdXRvMn19PC9lbT4KICAgICAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9ImNvbG9yOiAjZGQzOTM3O2ZvbnQtc2l6ZTogMzBweDtkaXNwbGF5OiBibG9jazt0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTsiPlIkIHt7cHJlY29fcHJvZHV0bzJ9fTwvc3Ryb25nPgogICAgICAgICAgICAgICAgPHNtYWxsIHN0eWxlPSJjb2xvcjogIzY2NjY2NjsiPjR4IGRlIFIkIHt7cGFyY2VsYV9wcm9kdXRvMn19IG5vIENhcnTDo28gQmVtb2w8L3NtYWxsPgogICAgICAgICAgICAgICAgPGEgaHJlZj0ie3tsaW5rX3Byb2R1dG8yfX0iICwgY2xhc3M9ImJ0X2NvbXByYXIiIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDE2cHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjtmbG9hdDogY2VudGVyO2Rpc3BsYXk6IGlubGluZS1ibG9jazt3aWR0aDogMTUwcHg7cGFkZGluZzogMTBweCAyMHB4O21hcmdpbi10b3A6IDEwcHg7YmFja2dyb3VuZC1jb2xvcjogI2RkMzkzNztib3JkZXItcmFkaXVzOiAxMHB4OyI+Q09NUFJBUjwvYT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImRpcmVpdGEiIHN0eWxlPSJ3aWR0aDogNTAlO3RleHQtYWxpZ246IHJpZ2h0O2Zsb2F0OiByaWdodDtkaXNwbGF5OiBpbmxpbmU7Ij4KICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJ7e2ltZ19wcm9kdXRvMn19IiAsIGNsYXNzPSJpbWdfcHJvZHV0byIgYWx0PSJ7e25vbWVfcHJvZHV0bzJ9fSIgc3R5bGU9IndpZHRoOiBhdXRvO2hlaWdodDogMjAwcHg7b2JqZWN0LWZpdDogc2NhbGUtZG93bjttYXJnaW4tYm90dG9tOiAxMHB4OyI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJyZWNvbWVuZGFjYW8iIHN0eWxlPSJ3aWR0aDogY2FsYygxMDAlIC0gNDBweCk7aGVpZ2h0OiAyMDBweDttYXJnaW46IDIwcHg7Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXNxdWVyZGEiIHN0eWxlPSJ3aWR0aDogNTAlO3RleHQtYWxpZ246IGxlZnQ7ZmxvYXQ6IGxlZnQ7ZGlzcGxheTogaW5saW5lOyI+CiAgICAgICAgICAgICAgICA8aW1nIHNyYz0ie3tpbWdfcHJvZHV0bzN9fSIgLCBjbGFzcz0iaW1nX3Byb2R1dG8iIGFsdD0ie3tub21lX3Byb2R1dG8zfX0iIHN0eWxlPSJ3aWR0aDogYXV0bztoZWlnaHQ6IDIwMHB4O29iamVjdC1maXQ6IHNjYWxlLWRvd247bWFyZ2luLWJvdHRvbTogMTBweDsiPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZGlyZWl0YSIgc3R5bGU9IndpZHRoOiA1MCU7dGV4dC1hbGlnbjogcmlnaHQ7ZmxvYXQ6IHJpZ2h0O2Rpc3BsYXk6IGlubGluZTsiPgogICAgICAgICAgICAgICAgPGVtIHN0eWxlPSJmb250LXN0eWxlOiBub3JtYWw7Zm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxOHB4O2Rpc3BsYXk6IGJsb2NrO21hcmdpbi10b3A6IDEwcHg7Ij57e25vbWVfcHJvZHV0bzN9fTwvZW0+CiAgICAgICAgICAgICAgICA8c3Ryb25nIHN0eWxlPSJjb2xvcjogI2RkMzkzNztmb250LXNpemU6IDMwcHg7ZGlzcGxheTogYmxvY2s7dGV4dC10cmFuc2Zvcm06IGNhcGl0YWxpemU7Ij5SJCB7e3ByZWNvX3Byb2R1dG8zfX08L3N0cm9uZz4KICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT0iY29sb3I6ICM2NjY2NjY7Ij40eCBkZSBSJCB7e3BhcmNlbGFfcHJvZHV0bzN9fSBubyBDYXJ0w6NvIEJlbW9sPC9zbWFsbD4KICAgICAgICAgICAgICAgIDxhIGhyZWY9Int7bGlua19wcm9kdXRvM319IiAsIGNsYXNzPSJidF9jb21wcmFyIiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Zm9udC1zaXplOiAxNnB4O2NvbG9yOiAjZmZmZmZmO3RleHQtZGVjb3JhdGlvbjogbm9uZTt0ZXh0LWFsaWduOiBjZW50ZXI7ZmxvYXQ6IGNlbnRlcjtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7d2lkdGg6IDE1MHB4O3BhZGRpbmc6IDEwcHggMjBweDttYXJnaW4tdG9wOiAxMHB4O2JhY2tncm91bmQtY29sb3I6ICNkZDM5Mzc7Ym9yZGVyLXJhZGl1czogMTBweDsiPkNPTVBSQVI8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8Zm9vdGVyPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhdmlzb19hYmVydG8iIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZjNjAwO3BhZGRpbmc6IDEwcHg7Ij4KICAgICAgICAgICAgICAgIDxoMSBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyO2ZvbnQtc2l6ZTogMjBweDtmb250LXdlaWdodDogYm9sZDsiPkFzIGZhcm3DoWNpYXMgZXN0w6NvIGFiZXJ0YXMgcGFyYSBwYWdhbWVudG9zIGRlIHBhcmNlbGFzIGRvIGNhcm7DqiBCZW1vbCE8L2gxPgogICAgICAgICAgICAgICAgPGEgaHJlZj0iIyIgLCBjbGFzcz0iYnRfaG9yYXJpb3MiIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDE2cHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjtmbG9hdDogY2VudGVyO2Rpc3BsYXk6IGJsb2NrO3dpZHRoOiAzMDBweDtwYWRkaW5nOiAxMHB4IDIwcHg7bWFyZ2luOiBhdXRvO2JhY2tncm91bmQtY29sb3I6ICNkZDM5Mzc7Ym9yZGVyLXJhZGl1czogMTBweDtib3gtc2hhZG93OiAxcHggMXB4IDJweCAjM0Q0NTREOyI+Q09ORklSQSBPUyBIT1LDgVJJT1M8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjZW50cmFsX2F0ZW5kaW1lbnRvIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzAwOTdkODtwYWRkaW5nOiAxMHB4OyI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzb2NpYWxfY29uanVudG8iIHN0eWxlPSJwYWRkaW5nLWxlZnQ6IGNhbGMoNTAlIC0gMTk2cHgpO3BhZGRpbmctcmlnaHQ6IGNhbGMoNTAlIC0gMTk2cHgpOyI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVkZXNfc29jaWFpcyIgc3R5bGU9IndpZHRoOiA3NXB4O2Rpc3BsYXk6IGlubGluZS1ibG9jazsiPgogICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJodHRwczovL3d3dy5mYWNlYm9vay5jb20vYmVtb2xvbmxpbmUiIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDEwcHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjtmbG9hdDogY2VudGVyO2Rpc3BsYXk6IGJsb2NrOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iaHR0cHM6Ly9naXRodWIuY29tL21hdGhldXNoZW5yaXF1ZS1weS9lbWFpbF9yZWNvbWVuZGFjYW8vcmF3L21hc3Rlci9kYXRhL2ZhY2Vib29rLnBuZyIgLCBjbGFzcz0ibG9nb19zb2NpYWwiIHN0eWxlPSJtYXJnaW46IGF1dG87cGFkZGluZy1ib3R0b206IDVweDtkaXNwbGF5OiBibG9jazt3aWR0aDogNDBweDtoZWlnaHQ6IGF1dG87b2JqZWN0LWZpdDogc2NhbGUtZG93bjsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZWJvb2sKICAgICAgICAgICAgICAgICAgICAgICAgPC9hPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlZGVzX3NvY2lhaXMiIHN0eWxlPSJ3aWR0aDogNzVweDtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly90d2l0dGVyLmNvbS9CZW1vbE9ubGluZSIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTBweDtjb2xvcjogI2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246IG5vbmU7dGV4dC1hbGlnbjogY2VudGVyO2Zsb2F0OiBjZW50ZXI7ZGlzcGxheTogYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJodHRwczovL2dpdGh1Yi5jb20vbWF0aGV1c2hlbnJpcXVlLXB5L2VtYWlsX3JlY29tZW5kYWNhby9yYXcvbWFzdGVyL2RhdGEvdHdpdHRlci5wbmciICwgY2xhc3M9ImxvZ29fc29jaWFsIiBzdHlsZT0ibWFyZ2luOiBhdXRvO3BhZGRpbmctYm90dG9tOiA1cHg7ZGlzcGxheTogYmxvY2s7d2lkdGg6IDQwcHg7aGVpZ2h0OiBhdXRvO29iamVjdC1maXQ6IHNjYWxlLWRvd247Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR3aXR0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgPC9hPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlZGVzX3NvY2lhaXMiIHN0eWxlPSJ3aWR0aDogNzVweDtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9iZW1vbG9ubGluZS8iIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDEwcHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjtmbG9hdDogY2VudGVyO2Rpc3BsYXk6IGJsb2NrOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iaHR0cHM6Ly9naXRodWIuY29tL21hdGhldXNoZW5yaXF1ZS1weS9lbWFpbF9yZWNvbWVuZGFjYW8vcmF3L21hc3Rlci9kYXRhL2luc3RhZ3JhbS5wbmciICwgY2xhc3M9ImxvZ29fc29jaWFsIiBzdHlsZT0ibWFyZ2luOiBhdXRvO3BhZGRpbmctYm90dG9tOiA1cHg7ZGlzcGxheTogYmxvY2s7d2lkdGg6IDQwcHg7aGVpZ2h0OiBhdXRvO29iamVjdC1maXQ6IHNjYWxlLWRvd247Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhZ3JhbQogICAgICAgICAgICAgICAgICAgICAgICA8L2E+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVkZXNfc29jaWFpcyIgc3R5bGU9IndpZHRoOiA3NXB4O2Rpc3BsYXk6IGlubGluZS1ibG9jazsiPgogICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJodHRwczovL3d3dy5saW5rZWRpbi5jb20vY29tcGFueS9iZW1vbC1mb2ctcyIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTBweDtjb2xvcjogI2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246IG5vbmU7dGV4dC1hbGlnbjogY2VudGVyO2Zsb2F0OiBjZW50ZXI7ZGlzcGxheTogYmxvY2s7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJodHRwczovL2dpdGh1Yi5jb20vbWF0aGV1c2hlbnJpcXVlLXB5L2VtYWlsX3JlY29tZW5kYWNhby9yYXcvbWFzdGVyL2RhdGEvbGlua2VkaW4ucG5nIiAsIGNsYXNzPSJsb2dvX3NvY2lhbCIgc3R5bGU9Im1hcmdpbjogYXV0bztwYWRkaW5nLWJvdHRvbTogNXB4O2Rpc3BsYXk6IGJsb2NrO3dpZHRoOiA0MHB4O2hlaWdodDogYXV0bztvYmplY3QtZml0OiBzY2FsZS1kb3duOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rZWRpbgogICAgICAgICAgICAgICAgICAgICAgICA8L2E+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVkZXNfc29jaWFpcyIgc3R5bGU9IndpZHRoOiA3NXB4O2Rpc3BsYXk6IGlubGluZS1ibG9jazsiPgogICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJodHRwczovL3d3dy55b3V0dWJlLmNvbS91c2VyL2xvamFzYmVtb2wiIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDEwcHg7Y29sb3I6ICNmZmZmZmY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjtmbG9hdDogY2VudGVyO2Rpc3BsYXk6IGJsb2NrOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iaHR0cHM6Ly9naXRodWIuY29tL21hdGhldXNoZW5yaXF1ZS1weS9lbWFpbF9yZWNvbWVuZGFjYW8vcmF3L21hc3Rlci9kYXRhL3lvdXR1YmUucG5nIiAsIGNsYXNzPSJsb2dvX3NvY2lhbCIgc3R5bGU9Im1hcmdpbjogYXV0bztwYWRkaW5nLWJvdHRvbTogNXB4O2Rpc3BsYXk6IGJsb2NrO3dpZHRoOiA0MHB4O2hlaWdodDogYXV0bztvYmplY3QtZml0OiBzY2FsZS1kb3duOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5b3V0dWJlCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGgyIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7Zm9udC1zaXplOiAyMHB4O2ZvbnQtd2VpZ2h0OiBib2xkO2NvbG9yOiAjZmZmZmZmO21hcmdpbjogMnB4OyI+Q2VudHJhbCBkZSBBdGVuZGltZW50byBCZW1vbDwvaDI+CiAgICAgICAgICAgICAgICA8aDIgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjtmb250LXNpemU6IDIwcHg7Zm9udC13ZWlnaHQ6IGJvbGQ7Y29sb3I6ICNmZmZmZmY7bWFyZ2luOiAycHg7Ij4wODAwIDcyNiA4MzAwPC9oMj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9mb290ZXI+CiAgICA8L2Rpdj4KPC9ib2R5Pgo8L2h0bWw+"

def email_campos(i):
    return {"nm_envio": "Recomendação de produtos", "nm_email": emails_teste[i], "nm_subject": "Qual o título que eu ponho?",
           "nm_remetente": "Bemol Online", "email_remetente": "no-reply@bemol.com.br", "nm_reply": "no-reply@bemol.com.br",
           "dt_envio": str(date.today()), "hr_envio": str(datetime.time(datetime.now())),
           "campos":"nome_produto1,nome_produto2,nome_produto3,preco_produto1,preco_produto2,preco_produto3,parcela_produto1,parcela_produto2,parcela_produto3,link_produto1,link_produto2,link_produto3,img_produto1,img_produto2,img_produto3",
           "valor": df_produtos['Nome'].to_list()[i] + "," + df_produtos['Nome'].to_list()[i+1] + "," + df_produtos['Nome'].to_list()[i+2] + "," + "{:.2f}".format(precos[i]) + "," + "{:.2f}".format(precos[i+1]) + "," + "{:.2f}".format(precos[i+2]) + "," + "{:.2f}".format(precos[i]/4) + "," + "{:.2f}".format(precos[i+1]/4) + "," + "{:.2f}".format(precos[i+2]/4) + "," + df_produtos['Link'].to_list()[i] + "," + df_produtos['Link'].to_list()[i+1] + "," + df_produtos['Link'].to_list()[i+2] + "," + df_produtos['Imagem'].to_list()[i] + "," + df_produtos['Imagem'].to_list()[i+1] + "," + df_produtos['Imagem'].to_list()[i+2],
            "html": template}


for i in range(len(emails_teste)):
    response = requests.post("http://transacional-apiv2.allin.com.br/api/email", headers=headers, json=email_campos(i))
    print(response.json())

''' Falta:
add o fuso horário
retirar esse dataframe pandas
'''